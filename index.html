<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –°–ª–æ–≤–∞—Ä—å-–ê–≤–∞—Ç–∞—Ä</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #120C1C; --surface: #1E1234; --primary: #A450F3; --accent: #F72585; --text: #EAE2FF; --border: #3A2E59; --input-bg: #0b0711; }
        * { box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        
        #editor-container { max-width: 1000px; width: 100%; background-color: var(--surface); padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid var(--border); }
        h1 { text-align: center; margin-bottom: 30px; text-shadow: 0 0 10px var(--accent); }
        .editor-layout { display: flex; flex-wrap: wrap; gap: 30px; }
        .col { flex: 1; min-width: 320px; display: flex; flex-direction: column; gap: 15px; }
        
        /* Preview */
        #preview-box {
            position: relative;
            background-image: linear-gradient(45deg, #181818 25%, transparent 25%), linear-gradient(-45deg, #181818 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #181818 75%), linear-gradient(-45deg, transparent 75%, #181818 75%);
            background-size: 20px 20px; background-color: #222; border: 1px dashed #555; border-radius: 20px;
            overflow: hidden; width: 100%; height: 500px; display: flex; justify-content: center; align-items: center;
        }
        
        .widget-wrapper { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; position: relative; }
        
        /* Avatar UI Styles */
        .avatar-ring { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--border); background: var(--bg); cursor: pointer; position: absolute; z-index: 10; display: flex; justify-content: center; align-items: center; transition: 0.3s; }
        .avatar-ring:hover { transform: scale(1.05); }
        .avatar-ring img { width: 90%; height: 90%; border-radius: 50%; object-fit: cover; }
        
        .chat-window { width: 90%; height: 90%; background: var(--bg); border: 1px solid var(--border); border-radius: 20px; display: flex; flex-direction: column; position: absolute; z-index: 20; opacity: 0; pointer-events: none; transform: scale(0.9); transition: all 0.3s; box-shadow: 0 10px 50px rgba(0,0,0,0.7); }
        .chat-window.open { opacity: 1; pointer-events: all; transform: scale(1); }
        
        .chat-header { padding: 15px; background: rgba(255,255,255,0.05); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .header-info { display: flex; align-items: center; gap: 10px; font-weight: 600; }
        .header-avatar { width: 35px; height: 35px; border-radius: 50%; object-fit: cover; }
        .close-btn { background: none; border: none; color: #aaa; cursor: pointer; font-size: 24px; line-height: 1; }
        
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message { display: flex; align-items: flex-end; gap: 8px; max-width: 85%; }
        .msg-avatar { width: 28px; height: 28px; border-radius: 50%; object-fit: cover; flex-shrink: 0; }
        .bubble { padding: 10px 14px; border-radius: 18px; font-size: 0.9rem; line-height: 1.4; word-wrap: break-word; }
        
        .msg-bot { align-self: flex-start; }
        .msg-bot .bubble { background: rgba(255,255,255,0.1); border-bottom-left-radius: 2px; }
        .msg-user { align-self: flex-end; flex-direction: row-reverse; }
        .msg-user .bubble { background: var(--accent); color: white; border-bottom-right-radius: 2px; }
        
        .chat-input-area { padding: 15px; background: rgba(0,0,0,0.2); border-top: 1px solid var(--border); display: flex; gap: 10px; }
        .chat-input { flex: 1; background: var(--input-bg); border: 1px solid var(--border); border-radius: 20px; padding: 10px 15px; color: white; outline: none; }
        .send-btn { background: var(--accent); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; justify-content: center; align-items: center; transition: 0.2s; }
        .send-btn:hover { transform: scale(1.1); }
        .send-btn svg { width: 18px; fill: white; margin-left: 2px; }

        /* Settings */
        .custom-file { padding: 12px; background: rgba(0,0,0,0.2); border: 1px dashed var(--border); text-align: center; cursor: pointer; border-radius: 8px; position: relative; }
        .file-input { position: absolute; top:0; left:0; width:100%; height:100%; opacity:0; cursor:pointer; }
        
        input[type="text"], input[type="url"], select { width: 100%; padding: 10px; background: var(--input-bg); border: 1px solid var(--border); border-radius: 8px; color: white; }
        input[type="color"] { width: 100%; height: 40px; border: none; background: none; cursor: pointer; }
        
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; background: linear-gradient(90deg, #A450F3, #F72585); color: white; font-weight: 600; cursor: pointer; margin-top: 10px; }
        
        /* Dictionary Textarea */
        textarea.dict-input { width: 100%; height: 200px; background: #0b0711; border: 1px solid var(--border); color: #fff; border-radius: 8px; padding: 10px; resize: vertical; font-family: monospace; white-space: pre; overflow: auto; }
        textarea.code-output { width: 100%; height: 100px; background: #0b0711; border: 1px solid var(--border); color: #888; border-radius: 8px; padding: 10px; resize: none; font-size:11px;}
        
        .hint { font-size: 0.8rem; color: #aaa; margin-top: -5px; line-height: 1.4; }
    </style>
</head>
<body>

<div id="editor-container">
    <h1>üìö –ê–≤–∞—Ç–∞—Ä-–°–ª–æ–≤–∞—Ä—å (–ë–µ–∑ API)</h1>
    <div class="editor-layout">
        <!-- Preview -->
        <div class="col" style="flex: 1.5;">
            <div id="preview-box">
                <div class="widget-wrapper">
                    <!-- Ring -->
                    <div class="avatar-ring" id="prev-ring" onclick="toggleChat()">
                        <img id="prev-img-ring" src="">
                    </div>
                    <!-- Chat -->
                    <div class="chat-window" id="prev-chat">
                        <div class="chat-header">
                            <div class="header-info">
                                <img id="prev-img-head" class="header-avatar" src="">
                                <span id="prev-name">Avatar</span>
                            </div>
                            <button class="close-btn" onclick="toggleChat()">√ó</button>
                        </div>
                        <div class="chat-messages" id="prev-msgs"></div>
                        <div class="chat-input-area">
                            <input type="text" class="chat-input" id="prev-in" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ...">
                            <button class="send-btn" onclick="simSend()"><svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg></button>
                        </div>
                    </div>
                </div>
            </div>
            <p style="text-align:center; color:#888; font-size:0.9rem; margin-top:5px;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–æ –∏–∑ –≤–∞—à–µ–≥–æ —Å–ª–æ–≤–∞—Ä—è —Å–ø—Ä–∞–≤–∞.</p>
        </div>

        <!-- Settings -->
        <div class="col">
            <label class="custom-file">
                <span id="label-img">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å –ê–≤–∞—Ç–∞—Ä</span>
                <input type="file" id="inp-img" accept="image/*" class="file-input">
            </label>

            <span style="font-weight:600">–ë–∞–∑–∞ –ó–Ω–∞–Ω–∏–π (–°–ª–æ–≤–∞—Ä—å):</span>
            <div class="hint">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä—ã: <b>–°–ª–æ–≤–æ - –ó–Ω–∞—á–µ–Ω–∏–µ</b> (–∫–∞–∂–¥–æ–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏).</div>
            <textarea id="inp-dict" class="dict-input" placeholder="–ü—Ä–∏–≤–µ—Ç - –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π, —É—á–µ–Ω–∏–∫!
Cat - –ö–æ—Ç, –¥–æ–º–∞—à–Ω–µ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ.
London - Capital of Great Britain.
–§–æ—Ä–º—É–ª–∞ - E = mc^2"></textarea>
            
            <span style="font-weight:600">–û—Ç–≤–µ—Ç, –µ—Å–ª–∏ —Å–ª–æ–≤–∞ –Ω–µ—Ç –≤ –±–∞–∑–µ:</span>
            <input type="text" id="inp-unknown" value="–Ø –Ω–µ –∑–Ω–∞—é —Ç–∞–∫–æ–≥–æ —Å–ª–æ–≤–∞. –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–µ.">

            <span style="font-weight:600">–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ:</span>
            <input type="text" id="inp-welcome" value="–ü—Ä–∏–≤–µ—Ç! –ù–∞–ø–∏—à–∏ —Å–ª–æ–≤–æ, –∏ —è –¥–∞–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.">

            <span style="font-weight:600">–¶–≤–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π:</span>
            <input type="color" id="inp-accent" value="#F72585">
            
            <button id="btn-copy" class="btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
            <textarea id="output-code" class="code-output" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥..."></textarea>
        </div>
    </div>
</div>

<script>
    // Default Assets
    const defBot = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23cccccc'%3E%3Cpath d='M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2'/%3E%3C/svg%3E";
    const defUser = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23888888'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E";

    // UI Elements
    const els = {
        imgRing: document.getElementById('prev-img-ring'),
        imgHead: document.getElementById('prev-img-head'),
        chatWin: document.getElementById('prev-chat'),
        msgs: document.getElementById('prev-msgs'),
        inp: document.getElementById('prev-in'),
        // Inputs
        file: document.getElementById('inp-img'),
        dict: document.getElementById('inp-dict'),
        unk: document.getElementById('inp-unknown'),
        wel: document.getElementById('inp-welcome'),
        acc: document.getElementById('inp-accent'),
        code: document.getElementById('output-code'),
        copy: document.getElementById('btn-copy'),
        label: document.getElementById('label-img')
    };

    let state = { avatar: defBot, isUser: false, open: false };

    // Init
    els.imgRing.src = state.avatar;
    els.imgHead.src = state.avatar;
    
    // Default dictionary content
    els.dict.value = "–ü—Ä–∏–≤–µ—Ç - –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π! –Ø –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏.\nApple - –Ø–±–ª–æ–∫–æ, –≤–∫—É—Å–Ω—ã–π —Ñ—Ä—É–∫—Ç.\nGenially - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.";

    // Handlers
    els.file.onchange = e => {
        const f = e.target.files[0];
        if(f) {
            const r = new FileReader();
            r.onload = v => {
                state.avatar = v.target.result;
                state.isUser = true;
                els.imgRing.src = state.avatar;
                els.imgHead.src = state.avatar;
                els.label.innerText = "‚úÖ –§–æ—Ç–æ –≥–æ—Ç–æ–≤–æ";
                refreshChat();
            };
            r.readAsDataURL(f);
        }
    };

    window.toggleChat = () => {
        state.open = !state.open;
        if(state.open) {
            els.chatWin.classList.add('open');
            if(els.msgs.children.length === 0) addMsg('bot', els.wel.value);
        } else {
            els.chatWin.classList.remove('open');
        }
    };

    function addMsg(role, text) {
        const div = document.createElement('div');
        div.className = `message msg-${role}`;
        
        const img = document.createElement('img');
        img.className = 'msg-avatar';
        img.src = role === 'bot' ? state.avatar : defUser;
        
        const bub = document.createElement('div');
        bub.className = 'bubble';
        if(role === 'user') bub.style.background = els.acc.value;
        bub.innerText = text;

        div.appendChild(img);
        div.appendChild(bub);
        
        // Order fix for flex reverse
        if(role === 'user') { div.insertBefore(bub, img); }
        
        els.msgs.appendChild(div);
        els.msgs.scrollTop = els.msgs.scrollHeight;
    }

    function refreshChat() {
        els.msgs.innerHTML = '';
        if(state.open) addMsg('bot', els.wel.value);
    }

    // Parse Dictionary
    function parseDictionary() {
        const lines = els.dict.value.split('\n');
        const db = {};
        lines.forEach(line => {
            const parts = line.split('-');
            if(parts.length >= 2) {
                const key = parts[0].trim().toLowerCase();
                const val = parts.slice(1).join('-').trim(); // Join back in case description has hyphens
                if(key) db[key] = val;
            }
        });
        return db;
    }

    // Simulation for Preview
    window.simSend = () => {
        const val = els.inp.value.trim();
        if(!val) return;
        addMsg('user', val);
        els.inp.value = '';
        
        // Local logic
        const db = parseDictionary();
        const key = val.toLowerCase();
        let answer = db[key];
        
        if(!answer) answer = els.unk.value;
        
        setTimeout(() => addMsg('bot', answer), 400);
    };

    // Live update
    els.acc.oninput = () => {
        document.querySelector('.send-btn').style.background = els.acc.value;
        refreshChat();
    };
    els.wel.oninput = refreshChat;

    // Generate Code
    els.copy.onclick = () => {
        const code = getCode();
        els.code.value = code;
        els.code.select();
        document.execCommand('copy');
        els.copy.innerText = "‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
        setTimeout(() => els.copy.innerText = "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥", 2000);
    };

    function getCode() {
        const uid = "dict-" + Math.random().toString(36).substr(2,6);
        const av = state.isUser ? state.avatar : defBot;
        const us = defUser;
        const col = els.acc.value;
        const wel = els.wel.value;
        const unk = els.unk.value;
        
        // Convert Textarea to JSON Object string
        const dictObj = JSON.stringify(parseDictionary());

        return `
<!DOCTYPE html>
<html>
<head><meta charset="utf-8"></head>
<body style="margin:0;padding:0;width:100%;height:100%;background:transparent;overflow:hidden;font-family:sans-serif;">
<style>
* { box-sizing: border-box; }
#${uid} { width:100%; height:100%; display:flex; justify-content:center; align-items:center; position:relative; }

/* Ring */
#${uid} .ring { width:90px; height:90px; border-radius:50%; background:#1E1234; border:3px solid rgba(255,255,255,0.3); cursor:pointer; display:flex; justify-content:center; align-items:center; box-shadow:0 5px 15px rgba(0,0,0,0.4); transition:0.3s; z-index:1; }
#${uid} .ring:hover { transform:scale(1.05); }
#${uid} .ring img { width:90%; height:90%; border-radius:50%; object-fit:cover; }

/* Chat */
#${uid} .win { position:absolute; width:98%; height:98%; background:#120C1C; border-radius:15px; border:1px solid #3A2E59; display:flex; flex-direction:column; box-shadow:0 10px 30px rgba(0,0,0,0.6); opacity:0; pointer-events:none; transform:scale(0.9); transition:0.3s; z-index:2; color:#fff; }
#${uid} .win.show { opacity:1; pointer-events:all; transform:scale(1); }

#${uid} .head { padding:10px; background:rgba(255,255,255,0.05); border-bottom:1px solid #3A2E59; display:flex; justify-content:space-between; align-items:center; }
#${uid} .prof { display:flex; align-items:center; gap:8px; font-size:14px; font-weight:bold; }
#${uid} .prof img { width:30px; height:30px; border-radius:50%; object-fit:cover; }
#${uid} .cls { background:none; border:none; color:#888; font-size:20px; cursor:pointer; }

#${uid} .logs { flex:1; padding:10px; overflow-y:auto; display:flex; flex-direction:column; gap:10px; scrollbar-width:thin; }
#${uid} .row { display:flex; gap:6px; max-width:90%; align-items:flex-end; font-size:13px; line-height:1.4; }
#${uid} .bot { align-self:flex-start; }
#${uid} .usr { align-self:flex-end; flex-direction:row-reverse; }
#${uid} .av { width:24px; height:24px; border-radius:50%; object-fit:cover; flex-shrink:0; }
#${uid} .txt { padding:8px 12px; border-radius:15px; word-wrap:break-word; }
#${uid} .bot .txt { background:rgba(255,255,255,0.1); border-bottom-left-radius:2px; }
#${uid} .usr .txt { background:${col}; color:#fff; border-bottom-right-radius:2px; }

#${uid} .inp { padding:8px; background:rgba(0,0,0,0.2); border-top:1px solid #3A2E59; display:flex; gap:6px; }
#${uid} input { flex:1; background:#0b0711; border:1px solid #3A2E59; border-radius:20px; padding:8px 12px; color:#fff; outline:none; }
#${uid} .snd { width:34px; height:34px; border-radius:50%; background:${col}; border:none; color:#fff; cursor:pointer; display:flex; justify-content:center; align-items:center; }
#${uid} .snd svg { width:16px; fill:white; margin-left:2px; }
</style>

<div id="${uid}">
    <div class="ring" id="r-${uid}"><img src="${av}"></div>
    <div class="win" id="w-${uid}">
        <div class="head">
            <div class="prof"><img src="${av}"><span>AI Assistant</span></div>
            <button class="cls" id="c-${uid}">√ó</button>
        </div>
        <div class="logs" id="l-${uid}"></div>
        <div class="inp">
            <input type="text" id="i-${uid}" placeholder="–ù–∞–ø–∏—à–∏ —Å–ª–æ–≤–æ...">
            <button class="snd" id="s-${uid}"><svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg></button>
        </div>
    </div>
</div>

<script>
(function(){
    var r = document.getElementById('r-${uid}');
    var w = document.getElementById('w-${uid}');
    var c = document.getElementById('c-${uid}');
    var l = document.getElementById('l-${uid}');
    var i = document.getElementById('i-${uid}');
    var s = document.getElementById('s-${uid}');
    
    // The Database
    var db = ${dictObj};
    var start = false;

    // Open/Close
    r.onclick = function(){ w.classList.add('show'); r.style.opacity='0'; r.style.pointerEvents='none'; if(!start){ add('bot',"${wel}"); start=true; } };
    c.onclick = function(){ w.classList.remove('show'); r.style.opacity='1'; r.style.pointerEvents='all'; };

    function add(who, msg) {
        var d = document.createElement('div'); d.className = 'row ' + who;
        var im = document.createElement('img'); im.className = 'av'; im.src = who==='bot'?"${av}":"${us}";
        var t = document.createElement('div'); t.className = 'txt';
        t.innerText = msg;
        d.appendChild(im); d.appendChild(t);
        l.appendChild(d); l.scrollTop = l.scrollHeight;
    }

    function send() {
        var v = i.value.trim();
        if(!v) return;
        add('usr', v);
        i.value = '';
        
        // Search logic
        var key = v.toLowerCase();
        var ans = db[key];
        
        // Fuzzy search fallback (if exact match not found)
        if(!ans) {
            // Check if user input is contained in any key
            var found = Object.keys(db).find(k => k.includes(key) || key.includes(k));
            if(found) ans = db[found];
        }

        if(!ans) ans = "${unk}";

        setTimeout(function(){ add('bot', ans); }, 300);
    }

    s.onclick = send;
    i.onkeypress = function(e){ if(e.key==='Enter') send(); };
})();
<\/script>
</body>
</html>`;
    }
</script>
</body>
</html>
      
        
       
   
          
        
        


            
            
            
        
        
                        
           
       
